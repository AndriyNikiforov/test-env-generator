"use strict";const officegen=require("officegen"),{error,log}=require("console"),{resolve,join}=require("path"),{createWriteStream,copyFile}=require("fs-extra"),{table,tableStyle,config,projectTextConfig}=require("../config/testCase");class Document{constructor(){this.docx=officegen(config),this.pObject=this.docx.createP(),this.copyPath="../assets/docs/TEMPLATE_TEST_CASE.xlsx",this.messageSuccess=["\x1B[36m%s\x1B[0m","SUCCESS"]}async buildTemplate(a,b){const c=createWriteStream(join("./",`${a.fileName||"file"}_${b}.docx`)),d=table(a);this.pObject.addText(a.projectName,projectTextConfig),this.pObject=this.docx.createTable(d,tableStyle),c.on("error",a=>error(a)),c.on("close",()=>log(...this.messageSuccess)),this.docx.on("error",a=>error(a)),await this.docx.generate(c)}async emptyTemplateDoc(a,b){await copyFile(resolve(__dirname,a),`./test-case-template.${b}`,a=>{a&&error(a),log(...this.messageSuccess)})}async getTemplate(){copyFile(resolve(__dirname,this.copyPath),"./test-template-table.xlsx",a=>{a&&error(a),log(...this.messageSuccess)})}}module.exports=new Document;